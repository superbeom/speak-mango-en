# 고급 학습 기능 및 단어장 시스템 기획 (Advanced Learning Features & Wordbook Strategy)

> **문서 개요**: 브레인스토밍된 내용을 바탕으로, 사용자 페이지(My Page)의 심화 학습 모드와 커스텀 단어장(Vocabulary List) 시스템의 요구사항 및 기술적 설계를 구체화합니다.

## 1. 핵심 인터랙션 및 관리 전략 (Core Interaction & Management Strategy)

서비스의 정체성을 강화하기 위해 단순한 '좋아요' 기능을 제거하고, **저장(Save)**과 **학습 완료(Learn)** 두 가지 핵심 액션에 집중합니다. 인기 순위(인기 표현)는 사용자가 실제로 학습을 위해 저장한 횟수(Save count)를 기준으로 산정하여 지표의 신뢰도를 높입니다.

---

## 2. 마이 페이지 학습 모드 (My Page Learning Modes)

'저장한 표현(Saved)'과 '학습한 표현(Learned)' 목록을 단순히 리스트로 보여주는 것을 넘어, 4가지 심화 학습 뷰(View)를 제공합니다.

### 2-1. 학습 뷰 종류

#### A. 플래시카드 모드 (Flashcard Mode)

암기 학습을 위한 시각적 도구입니다.

- **기본 동작**: 카드 앞면(영어 표현) <-> 뒷면(한글 뜻) 뒤집기 인터랙션.
- **필터/설정**:
  - **Expression Only**: 영어 표현만 보고 뜻 맞추기.
  - **Meaning Only**: 뜻만 보고 영어 표현 떠올리기.
- **기능**:
  - **개별 뒤집기**: 카드 클릭 시 해당 카드만 Flip.
  - **전체 뒤집기 (Toggle All)**: 화면 내 모든 카드를 일괄적으로 앞/뒤면 전환.

#### B. 리스닝 모드 (Listening Mode)

`dialogue` 데이터가 있는 공식 콘텐츠 전용입니다.

- **UI 구성**: `app/quiz/page.tsx`와 유사하게, 한 번에 하나의 표현에 집중하는 카드형 뷰.
- **기능**:
  - **Step-by-Step 재생**: 하나의 표현에 대한 전체 대화문을 청취하고 스스로 넘어가는 방식 (Self-Paced).
  - **스크립트 가리기**: 리스닝 집중을 위해 블러 처리 토글.
- **제약 사항**: '커스텀 단어(오디오 없음)'는 이 모드에서 자동 제외됩니다.

#### C. 퀴즈 모드 (Quiz Mode)

내가 모은 표현들로 생성하는 맞춤형 테스트입니다.

- **데이터 소스**: 현재 보고 있는 목록('저장됨' 또는 특정 단어장)의 표현들.
- **형식 1: 기본형 (Basic Check)**: 현재 퀴즈 페이지(`app/quiz/page.tsx`)와 동일한 형식.
- **형식 2: 심화형 (Advanced Interactive)**: 더 몰입도 높은 인터랙션 제공.
  - **문장 완성형 (Sentence Building)**: 흩어진 단어 조각(Chips)을 순서대로 탭하여 문장 완성.
  - **받아쓰기 (Dictation)**: 오디오를 듣고 문장을 타이핑 (힌트 제공).
  - **롤플레잉 (Role Play)**: 대화문 중 내 역할(A or B)의 대사를 마이크로 말하기 (향후 STT 도입 시) 또는 선택지 고르기.
  - **실행 옵션**: 각 모드를 선택하거나, 세 형식을 섞어서(Mixed) 실행할 수 있습니다.
- **제약 사항**: '커스텀 단어(퀴즈 데이터 없음)'는 제외됩니다.

#### D. 강화 학습 모드 (Reinforcement Mode)

일명 "오답 노트" 또는 "집중 케어" 모드입니다.

- **개념**: 단어장 분류와 상관없이, 사용자가 "잘 안 외워짐" 또는 "중요함"으로 별도 마킹한 표현들의 집합.
- **UX**: 학습 도중(플래시카드, 퀴즈 등) 어디서든 `📌 Pin` 또는 `⚡ Weak` 버튼을 눌러 추가.
- **활용**: 시험 직전이나 자투리 시간에 이 목록만 반복 학습.

---

## 3. 단어장 시스템 (Vocabulary List System)

단순한 '저장'을 넘어, 사용자가 직접 큐레이션할 수 있는 폴더 시스템을 도입합니다.

### 3-1. 구조 및 기능

- **커스텀 단어장 생성**: 사용자가 이름(예: '여행 영어', '비즈니스 이메일')을 지정하여 생성.
- **편집 모드 (Bulk Actions)**: 리스트에서 다중 선택(Select Mode) 후 작업 수행.

### 3-2. 이동 및 복사 로직 (Copy vs Move)

- **복사 (Copy)**:
  - 기존 위치: 유지.
  - 새 단어장: 추가됨. (1:N 관계 - 하나의 표현이 여러 단어장에 존재 가능)
- **이동 (Move)**:
  - 기존 위치: 연결 해제(삭제).
  - 새 단어장: 추가됨. (정리 목적)

### 3-3. 저장 버튼 액션 로직 (Save UX)

`SaveButton` 클릭 시 사용자의 인지 부하를 줄이면서도 분류 욕구를 충족시키는 스마트한 저장 UX를 제공합니다.

1.  **디폴트 단어장 (Default List)**:
    - 사용자가 사전에 설정한 '기본 저장소'가 있다면 묻지 않고 **즉시 저장**합니다.
    - Toast 메시지로 "OOO 단어장에 저장되었습니다. (변경)"과 같이 알리고, 필요 시 변경할 수 있는 기회를 제공합니다.
2.  **단어장 선택 (List Selection)**:
    - 디폴트 설정이 없거나 길게 눌렀을(Long Press) 경우, **"어디에 저장할까요?"** 바텀 시트(모바일) 또는 모달(데스크톱)을 띄웁니다.
    - **멀티 셀렉트**: 체크박스를 통해 여러 단어장에 동시에 저장할 수 있습니다.
    - **새 단어장 만들기**: 모달 내에서 즉시 새로운 단어장을 생성하여 저장할 수 있습니다.

---

## 4. 커스텀 단어 추가 (Pro Feature)

유료 사용자 전용 기능으로, 사용자가 직접 표현을 등록할 수 있는 기능입니다.

### 4-1. 입력 데이터

- **필수**: Expression (영어), Meaning (뜻)
- **옵션**: Context (간단 메모)
- **삭제**: Tags (사용자 입력 피로도 감소 및 활용도 저하로 인해 제거)
- **제약**: Dialogue(음성), Quiz 데이터는 입력받지 않음 (복잡도 관리).

### 4-2. 모드별 호환성 정책

커스텀 단어는 데이터의 완결성이 공식 콘텐츠와 다르므로, 특정 모드에서는 배제합니다.

| 모드           | 지원 여부 | 비고                        |
| :------------- | :-------: | :-------------------------- |
| **플래시카드** |     O     | 텍스트 기반이므로 완벽 지원 |
| **리스닝**     |     X     | 오디오 데이터 부재로 배제   |
| **퀴즈**       |     X     | 퀴즈 메타데이터 부재로 배제 |
| **강화 학습**  |     O     | 사용자가 중요 표시 가능     |

### 4-3. 데이터베이스 설계 전략 (Schema Strategy)

'본인만의 커스텀 단어'는 `expressions` 테이블과 성격이 다르므로 **별도 테이블 분리**를 강력히 권장합니다.

#### 테이블 제안: `user_custom_cards`

| Column       | Type        | Description                   |
| :----------- | :---------- | :---------------------------- |
| `id`         | UUID        | PK                            |
| `user_id`    | UUID        | FK (소유자)                   |
| `list_id`    | UUID        | FK (속한 단어장 ID, Nullable) |
| `expression` | TEXT        | 사용자 입력 영어              |
| `meaning`    | TEXT        | 사용자 입력 뜻                |
| `memo`       | TEXT        | 사용자 메모                   |
| `created_at` | TIMESTAMPTZ | 생성일                        |

**분리 이유 (Why?)**:

1.  **데이터 오염 방지**: 공식 검증된 `expressions` 테이블의 퀄리티(AI 생성, 오디오 보유) 유지.
2.  **검색 성능**: 전체 공용 데이터와 개인 데이터를 섞어서 인덱싱할 필요 없음.
3.  **유연성**: 사용자 입력 데이터는 구조가 단순하므로(`jsonb` 불필요), 별도 관리가 효율적임.

#### 단어장 관리: `vocabulary_lists`

| Column      | Type    | Description                 |
| :---------- | :------ | :-------------------------- |
| `id`        | UUID    | PK                          |
| `user_id`   | UUID    | FK                          |
| `title`     | TEXT    | 단어장 이름                 |
| `is_system` | BOOLEAN | 기본 단어장(저장됨 등) 여부 |

#### 매핑 테이블: `vocabulary_items`

사용자 액션(`user_actions`) 테이블을 확장하거나, 단어장 전용 매핑 테이블을 사용합니다.
(표현 하나가 여러 단어장에 들어갈 수 있으므로 M:N 관계)

| Column           | Type | Description                   |
| :--------------- | :--- | :---------------------------- |
| `list_id`        | UUID | FK                            |
| `expression_id`  | UUID | FK (공식 표현 ID, Nullable)   |
| `custom_card_id` | UUID | FK (커스텀 카드 ID, Nullable) |

> **Note**: `expression_id`와 `custom_card_id` 중 하나만 값을 가집니다(Check Constraint). 이를 통해 하나의 단어장에서 공식 표현과 커스텀 단어를 함께 관리할 수 있습니다.
